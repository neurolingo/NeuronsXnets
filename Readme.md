# Dynamic Bit Array with Fast Rotate Operation

A dynamic bit array implementation has been developed specifically for storing and managing time series data of neuron spikes. 
The existing [Boost dynamic_bitset](https://www.boost.org/doc/libs/1_82_0/libs/dynamic_bitset/dynamic_bitset.html) implementation lacks certain essential operations 
required for algorithms dealing with the [Clustering Coefficients](https://pubmed.ncbi.nlm.nih.gov/25339742/) problem.
Among these operations, the most crucial one is an efficient implementation of the 'rotate' or 'circular shift' function. 
Applying the rotate algorithm to each element (bit) is straightforward, with the [STL library](https://en.cppreference.com/w/cpp/algorithm/rotate) offering iterator-based implementations and implementing it for each bit of the set is also relatively simple. However, the Boost library only provides left and right shift operations using blocks of bits (e.g., uint8_t, uint16_t, uint32_t, or uint64_t) and does not include the 'rotate' operation. In our BitArray implementation, we address this issue by offering a block-based efficient alternative for rotation.

Another challenge we need to address is as follows: given two time series represented by bit arrays A and B, we want to determine the number of spikes (i.e., 'one bits') in B that occur to the left of the bits in A within a specified range, Dt. In other words, we want to identify if a spike in A coincides with or follows a spike in B within a time window of Dt. Similarly, we need to handle the case of spikes occurring in the right direction. To support these functionalities, we have defined two operations: 'CreateLeftNeighbourMask(int Dt)' and 'CreateRightNeighbourMask(int Dt)'. These operations set the left or right bits at a distance of Dt. With the help of these masks, the functions can be reduced to performing a bitwise 'and' (&) operation between two arrays and counting the number of 'one bits'."

"There are two programs available for testing the operations and evaluating the efficiency of the rotate function. The TestBitArray.cpp program specifically tests the functionality of the 'rotate' and 'CreateMask' functions. Additionally, the profiler produces an image displaying time periods for both the elementwise rotate operation (located on the left of the top row) and the blockwise efficient implementation (located on the right side). This image is generated by the profiler of [CLion IDE](https://www.jetbrains.com/clion/).
![img.png](flamegraph.png)

"The second program, BenchRotate.cpp, utilizes the [Google Benchmark](https://github.com/google/benchmark) library to measure the execution time 
of the two versions of the rotate function. The obtained results are as follows: 
BM_Rotate represents our blockwise implementation of rotate, while BM_RotateRight corresponds to the elementwise implementation."

~~~
---------------------------------------------------------
Benchmark               Time             CPU   Iterations
---------------------------------------------------------
BM_Rotate           86687 ns        86687 ns         7612
BM_RotateRight   11240405 ns     11240271 ns           63
~~~